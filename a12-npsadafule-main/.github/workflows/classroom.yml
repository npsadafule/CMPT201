name: CI Runner
permissions:
  checks: write
  actions: read
  contents: read
on:
  workflow_dispatch:
  repository_dispatch:
  schedule:
    - cron: '0 9 6 12 *' # 9AM 12/6 UTC, 1AM 12/6 PT
jobs:
  run-autograding-tests:
    runs-on: self-hosted
    timeout-minutes: 10
    container: ghcr.io/sfu-cmpt-201/runner
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Grader
        uses: SFU-CMPT-201/graders/.github/actions/a12@main
      - name: Autograding Reporter
        uses: SFU-CMPT-201/autograding-grading-reporter@v1
      - name: Clean up
        run: |
          rm -rf ./* ./.* > /dev/null 2>&1 || true
        if: ${{ always() }}
